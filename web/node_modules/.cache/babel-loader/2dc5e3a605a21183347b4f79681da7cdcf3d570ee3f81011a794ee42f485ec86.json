{"ast":null,"code":"import _objectSpread from\"F:/Download/pph/web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState,useCallback}from'react';import{MapContainer,TileLayer,Marker,Popup,CircleMarker,Polyline,useMapEvents}from'react-leaflet';import L from'leaflet';import'leaflet/dist/leaflet.css';import{FaWater,FaCopy,FaTrash,FaPaste}from'react-icons/fa';import{puneLocations,puneCenter,getRiverColor,preSampledRiver,riverDescriptions}from'./locations';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_BASE=process.env.REACT_APP_API_BASE||'http://localhost:8000';// ensure leaflet marker icons load correctly when not using bundled images\ndelete L.Icon.Default.prototype._getIconUrl;L.Icon.Default.mergeOptions({iconRetinaUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',iconUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png'});function Calendar(_ref){let{date,onChange}=_ref;const base=date?new Date(date):new Date();const[viewMonth,setViewMonth]=React.useState(base.getMonth());const[viewYear,setViewYear]=React.useState(base.getFullYear());React.useEffect(()=>{const d=date?new Date(date):new Date();setViewMonth(d.getMonth());setViewYear(d.getFullYear());},[date]);const startOfMonth=(y,m)=>new Date(y,m,1);const daysInMonth=(y,m)=>new Date(y,m+1,0).getDate();const weeks=[];const firstDay=startOfMonth(viewYear,viewMonth).getDay();// 0=Sun\nconst leading=(firstDay+6)%7;// shift to Monday first (0=Mon)\nconst total=leading+daysInMonth(viewYear,viewMonth);const rows=Math.ceil(total/7);let day=1-leading;for(let r=0;r<rows;r++){const week=[];for(let c=0;c<7;c++,day++){const cellDate=new Date(viewYear,viewMonth,day);week.push(cellDate);}weeks.push(week);}const monthNames=Array.from({length:12},(_,i)=>new Date(2000,i).toLocaleString(undefined,{month:'long'}));const selectDate=d=>{const iso=\"\".concat(d.getFullYear(),\"-\").concat(String(d.getMonth()+1).padStart(2,'0'),\"-\").concat(String(d.getDate()).padStart(2,'0'));onChange&&onChange(iso);};const selected=date?new Date(date):null;return/*#__PURE__*/_jsxs(\"div\",{className:\"inline-calendar\",style:{padding:8,background:'#fff',border:'1px solid rgba(0,0,0,0.06)',borderRadius:'8px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:12,padding:'8px 0'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"calendar-nav-btn\",onClick:()=>{const m=viewMonth-1;if(m<0){setViewYear(v=>v-1);setViewMonth(11);}else{setViewMonth(m);}},style:{background:'#f8fafc',border:'1px solid #e2e8f0',borderRadius:'6px',padding:'8px 10px',cursor:'pointer',fontSize:'14px',color:'#334155'},children:'◀'}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:12,alignItems:'center'},children:[/*#__PURE__*/_jsx(\"select\",{value:viewMonth,onChange:e=>setViewMonth(Number(e.target.value)),style:{background:'#fff',border:'1px solid #d1d5db',borderRadius:'6px',padding:'6px 8px',fontSize:'14px',color:'#374151',cursor:'pointer',minWidth:'120px'},children:monthNames.map((mn,idx)=>/*#__PURE__*/_jsx(\"option\",{value:idx,children:mn},mn))}),/*#__PURE__*/_jsx(\"select\",{value:viewYear,onChange:e=>setViewYear(Number(e.target.value)),style:{background:'#fff',border:'1px solid #d1d5db',borderRadius:'6px',padding:'6px 8px',fontSize:'14px',color:'#374151',cursor:'pointer',minWidth:'80px'},children:Array.from({length:50}).map((_,i)=>viewYear-4+i).map(y=>/*#__PURE__*/_jsx(\"option\",{value:y,children:y},y))})]}),/*#__PURE__*/_jsx(\"button\",{className:\"calendar-nav-btn\",onClick:()=>{const m=viewMonth+1;if(m>11){setViewYear(v=>v+1);setViewMonth(0);}else{setViewMonth(m);}},style:{background:'#f8fafc',border:'1px solid #e2e8f0',borderRadius:'6px',padding:'8px 10px',cursor:'pointer',fontSize:'14px',color:'#334155'},children:'▶'})]}),/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(7,1fr)',gap:4,marginTop:8,fontSize:12,fontWeight:600,textAlign:'center',color:'#6b7280'},children:['Mo','Tu','We','Th','Fr','Sa','Su'].map(d=>/*#__PURE__*/_jsx(\"div\",{children:d},d))}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:8},children:weeks.map((week,i)=>/*#__PURE__*/_jsx(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(7,1fr)',gap:4,marginBottom:4},children:week.map(d=>{const inMonth=d.getMonth()===viewMonth;const isSelected=selected&&d.getFullYear()===selected.getFullYear()&&d.getMonth()===selected.getMonth()&&d.getDate()===selected.getDate();const isToday=new Date().toDateString()===d.toDateString();return/*#__PURE__*/_jsx(\"button\",{onClick:()=>inMonth&&selectDate(d),style:{padding:8,borderRadius:6,border:isToday?'2px solid #3b82f6':'1px solid transparent',background:isSelected?'#1976d2':inMonth?'#f8fafc':'transparent',color:isSelected?'#fff':inMonth?'#374151':'#9ca3af',cursor:inMonth?'pointer':'default',fontSize:'13px',fontWeight:isSelected||isToday?'600':'400',transition:'all 0.2s ease'},onMouseEnter:e=>{if(inMonth&&!isSelected){e.target.style.background='#e2e8f0';}},onMouseLeave:e=>{if(inMonth&&!isSelected){e.target.style.background='#f8fafc';}},children:d.getDate()},d.toISOString());})},i))})]});}function formatValue(key,value){if(value===null||value===undefined)return'—';const n=Number(value);if(!Number.isNaN(n)){if(/pH/i.test(key))return n.toFixed(3);if(/DO|BOD|FC|TC|MPN/i.test(key))return n.toFixed(2);return String(n);}return String(value);}function cleanQualityString(quality){if(quality===null||quality===undefined)return quality;let s=String(quality).trim();if(!s)return s;// normalize whitespace\ns=s.replace(/\\s+/g,' ');// remove duplicated trailing punctuation and normalize\ns=s.replace(/[\\s\\-–_:;,.]+$/g,'').trim();// collapse exact repeated phrases like \"X X\" or \"X X X\" -> \"X\"\nconst m=s.match(/^(.*?)\\s+(?:\\1\\s+)*\\1$/i);if(m&&m[1])return m[1].trim();// fallback: if full-string repeated twice (older regex)\nconst m2=s.match(/^(.*)\\s+\\1$/i);return m2?m2[1].trim():s;}function canonicalizePredictionEntries(pred){// returns array of [key, value] with keys normalized and duplicates collapsed (last value wins)\nif(!pred||typeof pred!=='object')return[];const map=new Map();for(const[k,v]of Object.entries(pred)){const key=String(k).trim();const norm=key.toLowerCase().replace(/\\s+/g,' ');// map some common aliases\nconst canonical=norm==='water quality'?'water quality':norm;map.set(canonical,{key:key,value:v});}// return in insertion order but using original key casing for display\nreturn Array.from(map.values()).map(x=>[x.key,x.value]);}// small helper component to forward map click events into lat/lon objects\nfunction MapClickHandler(_ref2){let{onMapClick}=_ref2;useMapEvents({click:e=>{onMapClick&&onMapClick({latitude:e.latlng.lat,longitude:e.latlng.lng});}});return null;}// basic parameter status mapping used by badges in the UI\nfunction getParameterStatus(param,value){if(value===null||value===undefined)return{cls:'status-na',label:'N/A'};const key=String(param||'').toLowerCase();const v=Number(value);if(key.includes('water quality')){const s=String(value||'').toLowerCase();if(s.includes('good')||s.includes('ok')||s.includes('acceptable'))return{label:'Good',cls:'status-good'};if(s.includes('moderate')||s.includes('borderline'))return{label:'Moderate',cls:'status-moderate'};return{label:String(value),cls:'status-poor'};}if(key.includes('pH')){if(isNaN(v))return{label:String(value),cls:'status-na'};if(v>=6.5&&v<=8.5)return{label:'Good',cls:'status-good'};if(v>=6&&v<6.5)return{label:'Moderate',cls:'status-moderate'};return{label:'Poor',cls:'status-poor'};}if(key.includes('do')){if(isNaN(v))return{label:String(value),cls:'status-na'};if(v>=5)return{label:'Good',cls:'status-good'};if(v>=3)return{label:'Moderate',cls:'status-moderate'};return{label:'Poor',cls:'status-poor'};}if(key.includes('bod')){if(isNaN(v))return{label:String(value),cls:'status-na'};if(v<=3)return{label:'Good',cls:'status-good'};if(v<=6)return{label:'Moderate',cls:'status-moderate'};return{label:'Poor',cls:'status-poor'};}if(key.includes('fc mpn/100ml')){if(isNaN(v))return{label:String(value),cls:'status-na'};if(v<=500)return{label:'Good',cls:'status-good'};if(v<=1000)return{label:'Moderate',cls:'status-moderate'};return{label:'Poor',cls:'status-poor'};}if(key.includes('tc mpn/100ml')){if(isNaN(v))return{label:String(value),cls:'status-na'};if(v<=1000)return{label:'Good',cls:'status-good'};if(v<=2000)return{label:'Moderate',cls:'status-moderate'};return{label:'Poor',cls:'status-poor'};}return{label:String(value),cls:'status-na'};}export default function App(){const[route,setRoute]=useState('home');const[mapInst,setMapInst]=useState(null);const[selectMode,setSelectMode]=useState(null);const[startPoint,setStartPoint]=useState(null);const[endPoint,setEndPoint]=useState(null);const[interpPoints,setInterpPoints]=useState([]);const[interpLoading,setInterpLoading]=useState(false);const[sampleCount,setSampleCount]=useState(5);const[selectedDate,setSelectedDate]=useState(()=>{const d=new Date();return\"\".concat(d.getFullYear(),\"-\").concat(String(d.getMonth()+1).padStart(2,'0'),\"-\").concat(String(d.getDate()).padStart(2,'0'));});const[predictions,setPredictions]=useState({});const[selected,setSelected]=useState(null);const[startInput,setStartInput]=useState('');const[endInput,setEndInput]=useState('');const[startRiver,setStartRiver]=useState(null);const[endRiver,setEndRiver]=useState(null);const[startStationName,setStartStationName]=useState(null);const[endStationName,setEndStationName]=useState(null);// Add missing state for forceIndexMedians\nconst[forceIndexMedians,setForceIndexMedians]=useState(false);const handleMapClick=useCallback(pt=>{if(selectMode==='start')setStartPoint(pt);else if(selectMode==='end')setEndPoint(pt);},[selectMode]);const handleMarkerClick=loc=>{// In interpolate route, if user is picking start or end, set them from known station\nif(route==='interpolate'&&selectMode==='start'){const coord=loc.coordinate||loc;setStartPoint({latitude:coord.latitude,longitude:coord.longitude});setStartInput(\"\".concat(coord.latitude.toFixed(6),\", \").concat(coord.longitude.toFixed(6)));setStartRiver(loc.river||null);setStartStationName(loc.name||null);setSelectMode(null);setInterpPoints([]);return;}if(route==='interpolate'&&selectMode==='end'){// guard: do not allow picking end on a different river than start\nif(startRiver&&loc.river&&startRiver!==loc.river){alert('Please pick an end station on the same river as the start station.');setSelectMode(null);return;}const coord=loc.coordinate||loc;setEndPoint({latitude:coord.latitude,longitude:coord.longitude});setEndInput(\"\".concat(coord.latitude.toFixed(6),\", \").concat(coord.longitude.toFixed(6)));setEndRiver(loc.river||null);setEndStationName(loc.name||null);setSelectMode(null);setInterpPoints([]);return;}// default behaviour: open details\nsetSelected(loc);// attach available prediction\nconst pred=predictions[loc.id]||null;setSelected(prev=>_objectSpread(_objectSpread({},loc),{},{prediction:pred}));};const performInterpolation=async()=>{if(!startPoint||!endPoint)return alert('Pick start and end');setInterpLoading(true);// use the provided sampled river segment (lat/lon array) and ask server to pick/sample across it\n// find nearest indices in preSampledRiver for the selected start/end and slice that array\nconst nearestIndex=pt=>{let best=0,bestD=Infinity;for(let i=0;i<preSampledRiver.length;i++){const dlat=preSampledRiver[i].latitude-pt.latitude;const dlng=preSampledRiver[i].longitude-pt.longitude;const d2=dlat*dlat+dlng*dlng;if(d2<bestD){bestD=d2;best=i;}}return best;};const si=nearestIndex(startPoint),ei=nearestIndex(endPoint);const a=Math.min(si,ei),b=Math.max(si,ei);const sub=preSampledRiver.slice(a,b+1);const d=new Date(selectedDate);const body={locations:sub,points:sampleCount,month:d.getMonth()+1,year:d.getFullYear(),pick_from_input:true,blend:'river'};// include explicit station-name override only when user forces index medians\nif(forceIndexMedians&&startStationName&&endStationName){body.start_station_name=startStationName;body.end_station_name=endStationName;}try{const res=await fetch(\"\".concat(API_BASE,\"/interpolate_predict\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)});const jb=await res.json();if(jb.error)return alert('Server: '+jb.error);const pts=jb.predictions||[];setInterpPoints(pts);// fit map to interpolated points if we have a map instance\ntry{if(mapInst&&pts&&pts.length>0){const latlngs=pts.map(p=>[p.latitude,p.longitude]);mapInst.fitBounds(latlngs,{padding:[40,40]});}}catch(e){}}catch(err){alert('Request failed');}finally{setInterpLoading(false);}};function haversineKm(a,b){if(!a||!b)return 0;const toRad=v=>v*Math.PI/180;const R=6371;const dLat=toRad(b.latitude-a.latitude);const dLon=toRad(b.longitude-a.longitude);const lat1=toRad(a.latitude);const lat2=toRad(b.latitude);const sinDlat=Math.sin(dLat/2),sinDlon=Math.sin(dLon/2);const aa=sinDlat*sinDlat+sinDlon*sinDlon*Math.cos(lat1)*Math.cos(lat2);const c=2*Math.atan2(Math.sqrt(aa),Math.sqrt(1-aa));return R*c;}const copyCoord=pt=>{if(!pt)return;const s=\"\".concat(pt.latitude.toFixed(6),\", \").concat(pt.longitude.toFixed(6));try{navigator.clipboard&&navigator.clipboard.writeText(s);}catch(e){}};const clearStart=()=>{setStartPoint(null);setInterpPoints([]);};const clearEnd=()=>{setEndPoint(null);setInterpPoints([]);};// Fetch predictions for all stations when app loads or selectedDate changes\nuseEffect(()=>{async function fetchPredictions(){if(!selectedDate)return;try{const d=new Date(selectedDate);const month=d.getMonth()+1;const year=d.getFullYear();const res=await fetch(\"\".concat(API_BASE,\"/predict_all?month=\").concat(month,\"&year=\").concat(year));const jb=await res.json();if(jb&&jb.predictions){// Map predictions to station id\nconst preds={};jb.predictions.forEach(pred=>{// Find location by name\nconst loc=puneLocations.find(l=>l.name===pred.location);if(loc&&loc.id)preds[loc.id]=pred;});setPredictions(preds);}}catch(err){// Optionally handle error\n}}fetchPredictions();},[selectedDate]);return/*#__PURE__*/_jsx(\"div\",{className:\"page\",children:/*#__PURE__*/_jsxs(\"main\",{className:\"main\",style:{display:'flex',gap:20},children:[/*#__PURE__*/_jsx(\"div\",{style:{flex:1},children:route==='home'?/*#__PURE__*/_jsx(\"div\",{className:\"home-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"home-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"home-hero\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(FaWater,{size:28,color:\"#fff\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"RiverWatch \\u2014 Pune Rivers\"}),/*#__PURE__*/_jsx(\"p\",{className:\"muted\",children:\"Water quality predictions for Pune rivers\"})]})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Explore predicted water quality across the Mula, Mutha and Mula-Mutha rivers. Use Predict for single-point queries and Interpolate to sample between two points.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"col rivers\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Rivers\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"river-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"river-name river-mula\",children:\"Mula\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"river-desc\",children:[(riverDescriptions['Mula']||'').split('. ')[0],\".\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"river-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"river-name river-mutha\",children:\"Mutha\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"river-desc\",children:[(riverDescriptions['Mutha']||'').split('. ')[0],\".\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"river-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"river-name river-mula-mutha\",children:\"Mula-Mutha\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"river-desc\",children:[(riverDescriptions['Mula-Mutha']||'').split('. ')[0],\".\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col center\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"About\"}),/*#__PURE__*/_jsx(\"p\",{children:\"This site reproduces the mobile water-quality model and exposes the same prediction logic on the web. It runs the trained model server-side and offers interpolation that follows river polylines so you can sample predicted values between two points. Use the map to select monitoring sites, compare parameter compliance across locations, and run multi-point interpolation to see spatial patterns for pH, dissolved oxygen, BOD and bacterial indicators across the river network.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"col params\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Parameters\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"param-names\",children:[/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"pH\"}),\" \",/*#__PURE__*/_jsx(\"div\",{className:\"desc\",children:\"Measures water acidity and alkalinity on a scale of 0-14, with 7 being neutral. Deviations indicate pollution from industrial discharge or organic decomposition affecting aquatic life.\"})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"DO\"}),\" \",/*#__PURE__*/_jsx(\"div\",{className:\"desc\",children:\"Dissolved oxygen levels in milligrams per liter, essential for fish and aquatic organisms. Low DO levels signal organic pollution and eutrophication from sewage or agricultural runoff.\"})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"BOD\"}),\" \",/*#__PURE__*/_jsx(\"div\",{className:\"desc\",children:\"Biological oxygen demand measures oxygen consumed by microorganisms breaking down organic matter. High BOD indicates sewage contamination and reduces available oxygen for aquatic life.\"})]}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"FC/TC\"}),\" \",/*#__PURE__*/_jsx(\"div\",{className:\"desc\",children:\"Fecal and total coliform bacteria counts per 100ml, indicating sewage contamination and potential health risks. High levels suggest inadequate wastewater treatment and pose serious public health concerns.\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"home-cta\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setRoute('predict'),children:\"Go to Predict\"}),/*#__PURE__*/_jsx(\"button\",{className:\"secondary\",onClick:()=>setRoute('interpolate'),children:\"Go to Interpolate\"})]})]})}):/*#__PURE__*/_jsx(\"div\",{className:\"main-content\",style:{height:'calc(100vh - 36px)'},children:/*#__PURE__*/_jsxs(MapContainer,{center:[puneCenter.latitude,puneCenter.longitude],zoom:puneCenter.zoom,className:\"map\",whenCreated:m=>setMapInst(m),style:{height:'100%'},children:[/*#__PURE__*/_jsx(TileLayer,{url:\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"}),/*#__PURE__*/_jsx(MapClickHandler,{onMapClick:handleMapClick}),puneLocations.map(loc=>{const pred=predictions[loc.id]||null;const entries=pred?canonicalizePredictionEntries(pred):[];const overallEntry=entries.find(_ref3=>{let[k]=_ref3;return String(k).toLowerCase()==='water quality';});const overallValue=overallEntry?cleanQualityString(String(overallEntry[1])):null;const overallStatus=overallEntry?getParameterStatus('Water Quality',overallEntry[1]):null;return/*#__PURE__*/_jsx(CircleMarker,{center:[loc.coordinate.latitude,loc.coordinate.longitude],pathOptions:{color:getRiverColor(loc.river),fillColor:getRiverColor(loc.river),fillOpacity:0.9},radius:8,eventHandlers:{click:()=>handleMarkerClick(loc)},children:/*#__PURE__*/_jsx(Popup,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"popup-card\",style:{minWidth:260},children:[/*#__PURE__*/_jsx(\"div\",{className:\"popup-header\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"popup-title\",children:cleanQualityString(loc.name)}),/*#__PURE__*/_jsxs(\"div\",{className:\"popup-sub muted\",style:{display:'flex',gap:8,alignItems:'center',marginTop:8},children:[/*#__PURE__*/_jsx(\"span\",{className:\"river-tag \".concat(cleanQualityString(loc.river).replace(/\\s+/g,'-').toLowerCase()),children:cleanQualityString(loc.river)}),overallValue?/*#__PURE__*/_jsx(\"div\",{className:\"badge \".concat(overallStatus?overallStatus.cls:'status-na'),children:overallValue}):null]})]})}),pred?/*#__PURE__*/_jsx(\"div\",{className:\"popup-grid\",children:entries.filter(_ref4=>{let[k]=_ref4;const key=String(k).toLowerCase();return!['location','location_name','river','month','year','id','water quality'].includes(key);}).map(_ref5=>{let[k,v]=_ref5;const value=formatValue(k,v);const s=getParameterStatus(k,v);// For pH, show value and status side by side\nif(String(k).toLowerCase()==='pH'){return/*#__PURE__*/_jsxs(\"div\",{className:\"param-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"param-name\",children:k}),/*#__PURE__*/_jsxs(\"div\",{className:\"param-value\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"val-text\",children:value}),/*#__PURE__*/_jsx(\"span\",{className:\"badge \".concat(s.cls),style:{marginLeft:8},children:s.label})]})]},k);}// For other parameters, show value and status as before\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"param-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"param-name\",children:k}),/*#__PURE__*/_jsxs(\"div\",{className:\"param-value\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"val-text\",children:value}),/*#__PURE__*/_jsx(\"span\",{className:\"badge \".concat(s.cls),style:{marginLeft:8},children:s.label})]})]},k);})}):/*#__PURE__*/_jsx(\"div\",{style:{marginTop:8},children:\"Loading...\"})]})})},loc.id);}),route==='interpolate'&&startPoint?/*#__PURE__*/_jsx(Marker,{position:[startPoint.latitude,startPoint.longitude],children:/*#__PURE__*/_jsx(Popup,{children:\"Start\"})}):null,route==='interpolate'&&endPoint?/*#__PURE__*/_jsx(Marker,{position:[endPoint.latitude,endPoint.longitude],children:/*#__PURE__*/_jsx(Popup,{children:\"End\"})}):null,route==='interpolate'&&interpPoints.length>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Polyline,{positions:interpPoints.map(p=>[p.latitude,p.longitude]),pathOptions:{color:'#0077b6',weight:3,opacity:0.7}}),interpPoints.map((pt,i)=>/*#__PURE__*/_jsx(CircleMarker,{center:[pt.latitude,pt.longitude],radius:6,pathOptions:{color:'#0077b6',fillColor:'#00b4d8',fillOpacity:0.9},children:/*#__PURE__*/_jsx(Popup,{children:/*#__PURE__*/_jsxs(\"div\",{style:{minWidth:220},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Interpolated\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"badge \".concat(getParameterStatus('Water Quality',pt['Water Quality']).cls),children:cleanQualityString(pt['Water Quality'])})]}),['pH','DO (mg/L)','BOD (mg/L)'].map((param,idx)=>{const val=pt[param];const valStr=val===null||val===undefined?'—':Number(val).toFixed(3);const status=getParameterStatus(param,val);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginTop:idx===0?8:4,borderTop:idx===0?'1px solid #edf2f7':'none',paddingTop:idx===0?8:0},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:13,color:'#334155',fontWeight:700},children:param}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:18,fontWeight:800,color:'#0b3b52'},children:valStr}),/*#__PURE__*/_jsx(\"div\",{className:\"badge \".concat(status.cls),children:status.label})]})]},param);}),['FC MPN/100ml','TC MPN/100ml'].map(param=>{if(pt[param]!==undefined&&pt[param]!==null){const val=pt[param];const valStr=val===null||val===undefined?'—':Number(val).toFixed(2);const status=getParameterStatus(param,val);return/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginTop:4},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:13,color:'#334155',fontWeight:700},children:param}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:8},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:15,fontWeight:700,color:'#0b3b52'},children:valStr}),/*#__PURE__*/_jsx(\"div\",{className:\"badge \".concat(status.cls),children:status.label})]})]},param);}return null;}),pt&&pt.t_frac!==undefined&&pt.t_frac!==null?/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,fontSize:12,color:'#64748b'},children:[\"Blend t: \",/*#__PURE__*/_jsx(\"strong\",{children:Number(pt.t_frac).toFixed(3)})]}):null]})})},i))]})]})})}),route!=='home'&&/*#__PURE__*/_jsxs(\"aside\",{className:\"detail-panel\",style:{width:360},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'flex-end',gap:8,padding:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setRoute('home'),className:\"small\",children:\"Home\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setRoute('interpolate'),className:\"small primary\",children:\"Interpolate\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"detail-calendar\",children:/*#__PURE__*/_jsx(Calendar,{date:selectedDate,onChange:d=>setSelectedDate(d)})}),route==='interpolate'&&/*#__PURE__*/_jsx(\"div\",{style:{marginTop:12},children:/*#__PURE__*/_jsxs(\"div\",{className:\"control-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"controls-row\",style:{marginBottom:8},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectMode(selectMode==='start'?null:'start'),className:selectMode==='start'?'active small primary':'',children:\"Pick Start\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectMode(selectMode==='end'?null:'end'),className:selectMode==='end'?'active small primary':'',children:\"Pick End\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectMode(null);setInterpPoints([]);setStartPoint(null);setEndPoint(null);setStartInput('');setEndInput('');setStartRiver(null);setEndRiver(null);setStartStationName(null);setEndStationName(null);},className:\"small\",children:\"Reset\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:8,color:'#0b3b52',fontSize:13},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Pick stations only\"}),\" \\u2014 interpolation will use river-linear blending\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:12,alignItems:'center',marginBottom:10},children:[/*#__PURE__*/_jsx(\"label\",{style:{margin:0,fontSize:13,color:'#475569'},children:\"Points k:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"input-box\",type:\"number\",min:1,max:50,value:sampleCount,onChange:e=>setSampleCount(Number(e.target.value))}),/*#__PURE__*/_jsxs(\"div\",{style:{marginLeft:'auto'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"small\",onClick:()=>{setSampleCount(Math.min(50,(sampleCount||1)+1));},children:\"+1\"}),/*#__PURE__*/_jsx(\"button\",{className:\"small\",onClick:()=>{setSampleCount(Math.max(1,(sampleCount||1)-1));},style:{marginLeft:6},children:\"-1\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"coord-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"coord-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"coord-label\",children:\"Start\"}),/*#__PURE__*/_jsx(\"input\",{className:\"coord-input\",readOnly:route==='interpolate',value:startInput||(startPoint?\"\".concat(startPoint.latitude.toFixed(6),\", \").concat(startPoint.longitude.toFixed(6)):''),onChange:e=>setStartInput(e.target.value),onBlur:e=>{if(route==='interpolate')return;// disable manual entry while in interpolate mode\nconst v=e.target.value.trim();if(!v)return;const parts=v.split(/[ ,]+/).map(x=>x.trim()).filter(Boolean);if(parts.length>=2){const lat=Number(parts[0]);const lon=Number(parts[1]);if(!isNaN(lat)&&!isNaN(lon))setStartPoint({latitude:lat,longitude:lon});}},onKeyDown:e=>{if(e.key==='Enter'){e.target.blur();}},placeholder:\"lat, lon\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"coord-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"small\",onClick:()=>{copyCoord(startPoint);},disabled:!startPoint,children:/*#__PURE__*/_jsx(FaCopy,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"small\",disabled:route==='interpolate',onClick:async()=>{try{const t=await navigator.clipboard.readText();setStartInput(t);const parts=t.split(/[ ,]+/).map(x=>x.trim()).filter(Boolean);if(parts.length>=2){const lat=Number(parts[0]),lon=Number(parts[1]);if(!isNaN(lat)&&!isNaN(lon))setStartPoint({latitude:lat,longitude:lon});}}catch(e){}},title:\"Paste from clipboard\",children:/*#__PURE__*/_jsx(FaPaste,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"small\",onClick:()=>{clearStart();setStartInput('');setStartRiver(null);setStartStationName(null);},disabled:!startPoint,style:{marginLeft:6},children:/*#__PURE__*/_jsx(FaTrash,{})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"coord-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"coord-box\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"coord-label\",children:\"End\"}),/*#__PURE__*/_jsx(\"input\",{className:\"coord-input\",readOnly:route==='interpolate',value:endInput||(endPoint?\"\".concat(endPoint.latitude.toFixed(6),\", \").concat(endPoint.longitude.toFixed(6)):''),onChange:e=>setEndInput(e.target.value),onBlur:e=>{if(route==='interpolate')return;// disable manual entry while in interpolate mode\nconst v=e.target.value.trim();if(!v)return;const parts=v.split(/[ ,]+/).map(x=>x.trim()).filter(Boolean);if(parts.length>=2){const lat=Number(parts[0]);const lon=Number(parts[1]);if(!isNaN(lat)&&!isNaN(lon))setEndPoint({latitude:lat,longitude:lon});}},onKeyDown:e=>{if(e.key==='Enter'){e.target.blur();}},placeholder:\"lat, lon\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"coord-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"small\",onClick:()=>{copyCoord(endPoint);},disabled:!endPoint,children:/*#__PURE__*/_jsx(FaCopy,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"small\",disabled:route==='interpolate',onClick:async()=>{try{const t=await navigator.clipboard.readText();setEndInput(t);const parts=t.split(/[ ,]+/).map(x=>x.trim()).filter(Boolean);if(parts.length>=2){const lat=Number(parts[0]),lon=Number(parts[1]);if(!isNaN(lat)&&!isNaN(lon))setEndPoint({latitude:lat,longitude:lon});}}catch(e){}},title:\"Paste from clipboard\",children:/*#__PURE__*/_jsx(FaPaste,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"small\",onClick:()=>{clearEnd();setEndInput('');setEndRiver(null);setEndStationName(null);},disabled:!endPoint,style:{marginLeft:6},children:/*#__PURE__*/_jsx(FaTrash,{})})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:8,display:'flex',alignItems:'center',justifyContent:'space-between'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"muted\",children:[\"Distance: \",/*#__PURE__*/_jsx(\"strong\",{style:{color:'#233249'},children:startPoint&&endPoint?\"\".concat(haversineKm(startPoint,endPoint).toFixed(2),\" km\"):'—'})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:8,marginLeft:12},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:12,color:'#475569'},children:forceIndexMedians?'Mode: Index medians (override)':'Mode: Distance/projection'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:performInterpolation,disabled:!startPoint||!endPoint||interpLoading,children:interpLoading?'Interpolating…':'Interpolate'})]})]})]})}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:16},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"selected-date\",children:[\"Selected date: \",/*#__PURE__*/_jsx(\"strong\",{children:new Date(selectedDate).toLocaleDateString()})]}),selected?/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:12},children:[/*#__PURE__*/_jsx(\"h3\",{children:cleanQualityString(selected.name)}),/*#__PURE__*/_jsxs(\"div\",{className:\"muted\",style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"river-tag \".concat(cleanQualityString(selected.river).replace(/\\s+/g,'-').toLowerCase()),children:cleanQualityString(selected.river)}),\" \\u2022 \",selected.description]}),selected.prediction?(()=>{const entries=canonicalizePredictionEntries(selected.prediction);const overall=entries.find(_ref6=>{let[k]=_ref6;return String(k).toLowerCase()==='water quality';});if(overall){const s=getParameterStatus('Water Quality',overall[1]);return/*#__PURE__*/_jsx(\"div\",{className:\"badge \".concat(s?s.cls:'status-na'),children:cleanQualityString(String(overall[1]))});}return null;})():null]}),/*#__PURE__*/_jsx(\"h4\",{style:{marginTop:8},children:\"Prediction\"}),selected.prediction?/*#__PURE__*/_jsx(\"div\",{children:canonicalizePredictionEntries(selected.prediction).filter(_ref7=>{let[k]=_ref7;const key=String(k).toLowerCase();return!['location','location_name','river','month','year','id','water quality'].includes(key);}).map(_ref8=>{let[k,v]=_ref8;const value=formatValue(k,v);const s=getParameterStatus(k,v);return/*#__PURE__*/_jsxs(\"div\",{className:\"inline-param-row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:k}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"val-text\",children:value}),/*#__PURE__*/_jsx(\"div\",{className:\"badge \".concat(s.cls),children:s.label})]})]},k);})}):/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"placeholder\",style:{marginTop:12},children:\"Select a location on the map to see details here.\"})]})]})]})});}","map":{"version":3,"names":["React","useEffect","useState","useCallback","MapContainer","TileLayer","Marker","Popup","CircleMarker","Polyline","useMapEvents","L","FaWater","FaCopy","FaTrash","FaPaste","puneLocations","puneCenter","getRiverColor","preSampledRiver","riverDescriptions","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_BASE","process","env","REACT_APP_API_BASE","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","Calendar","_ref","date","onChange","base","Date","viewMonth","setViewMonth","getMonth","viewYear","setViewYear","getFullYear","d","startOfMonth","y","m","daysInMonth","getDate","weeks","firstDay","getDay","leading","total","rows","Math","ceil","day","r","week","c","cellDate","push","monthNames","Array","from","length","_","i","toLocaleString","undefined","month","selectDate","iso","concat","String","padStart","selected","className","style","padding","background","border","borderRadius","children","display","justifyContent","alignItems","marginBottom","onClick","v","cursor","fontSize","color","gap","value","e","Number","target","minWidth","map","mn","idx","gridTemplateColumns","marginTop","fontWeight","textAlign","inMonth","isSelected","isToday","toDateString","transition","onMouseEnter","onMouseLeave","toISOString","formatValue","key","n","isNaN","test","toFixed","cleanQualityString","quality","s","trim","replace","match","m2","canonicalizePredictionEntries","pred","Map","k","Object","entries","norm","toLowerCase","canonical","set","values","x","MapClickHandler","_ref2","onMapClick","click","latitude","latlng","lat","longitude","lng","getParameterStatus","param","cls","label","includes","App","route","setRoute","mapInst","setMapInst","selectMode","setSelectMode","startPoint","setStartPoint","endPoint","setEndPoint","interpPoints","setInterpPoints","interpLoading","setInterpLoading","sampleCount","setSampleCount","selectedDate","setSelectedDate","predictions","setPredictions","setSelected","startInput","setStartInput","endInput","setEndInput","startRiver","setStartRiver","endRiver","setEndRiver","startStationName","setStartStationName","endStationName","setEndStationName","forceIndexMedians","setForceIndexMedians","handleMapClick","pt","handleMarkerClick","loc","coord","coordinate","river","name","alert","id","prev","_objectSpread","prediction","performInterpolation","nearestIndex","best","bestD","Infinity","dlat","dlng","d2","si","ei","a","min","b","max","sub","slice","body","locations","points","year","pick_from_input","blend","start_station_name","end_station_name","res","fetch","method","headers","JSON","stringify","jb","json","error","pts","latlngs","p","fitBounds","err","haversineKm","toRad","PI","R","dLat","dLon","lat1","lat2","sinDlat","sin","sinDlon","aa","cos","atan2","sqrt","copyCoord","navigator","clipboard","writeText","clearStart","clearEnd","fetchPredictions","preds","forEach","find","l","location","flex","size","split","height","center","zoom","whenCreated","url","overallEntry","_ref3","overallValue","overallStatus","pathOptions","fillColor","fillOpacity","radius","eventHandlers","filter","_ref4","_ref5","marginLeft","position","positions","weight","opacity","val","valStr","status","borderTop","paddingTop","t_frac","width","margin","type","readOnly","onBlur","parts","Boolean","lon","onKeyDown","blur","placeholder","disabled","t","readText","title","toLocaleDateString","description","overall","_ref6","_ref7","_ref8"],"sources":["F:/Download/pph/web/src/App.js"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\r\nimport { MapContainer, TileLayer, Marker, Popup, CircleMarker, Polyline, useMapEvents } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport 'leaflet/dist/leaflet.css';\r\nimport { FaWater, FaCopy, FaTrash, FaPaste } from 'react-icons/fa';\r\n\r\nimport { puneLocations, puneCenter, getRiverColor, preSampledRiver, riverDescriptions } from './locations';\r\n\r\nconst API_BASE = process.env.REACT_APP_API_BASE || 'http://localhost:8000';\r\n\r\n// ensure leaflet marker icons load correctly when not using bundled images\r\ndelete L.Icon.Default.prototype._getIconUrl;\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',\r\n  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',\r\n  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',\r\n});\r\nfunction Calendar({ date, onChange }) {\r\n  const base = date ? new Date(date) : new Date();\r\n  const [viewMonth, setViewMonth] = React.useState(base.getMonth());\r\n  const [viewYear, setViewYear] = React.useState(base.getFullYear());\r\n\r\n  React.useEffect(() => {\r\n    const d = date ? new Date(date) : new Date();\r\n    setViewMonth(d.getMonth());\r\n    setViewYear(d.getFullYear());\r\n  }, [date]);\r\n\r\n  const startOfMonth = (y, m) => new Date(y, m, 1);\r\n  const daysInMonth = (y, m) => new Date(y, m + 1, 0).getDate();\r\n\r\n  const weeks = [];\r\n  const firstDay = startOfMonth(viewYear, viewMonth).getDay(); // 0=Sun\r\n  const leading = (firstDay + 6) % 7; // shift to Monday first (0=Mon)\r\n  const total = leading + daysInMonth(viewYear, viewMonth);\r\n  const rows = Math.ceil(total / 7);\r\n\r\n  let day = 1 - leading;\r\n  for (let r = 0; r < rows; r++) {\r\n    const week = [];\r\n    for (let c = 0; c < 7; c++, day++) {\r\n      const cellDate = new Date(viewYear, viewMonth, day);\r\n      week.push(cellDate);\r\n    }\r\n    weeks.push(week);\r\n  }\r\n\r\n  const monthNames = Array.from({ length: 12 }, (_, i) => new Date(2000, i).toLocaleString(undefined, { month: 'long' }));\r\n\r\n  const selectDate = (d) => {\r\n    const iso = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;\r\n    onChange && onChange(iso);\r\n  };\r\n\r\n  const selected = date ? new Date(date) : null;\r\n\r\n  return (\r\n    <div className=\"inline-calendar\" style={{ padding: 8, background: '#fff', border: '1px solid rgba(0,0,0,0.06)', borderRadius: '8px' }}>\r\n      <div style={{ \r\n        display: 'flex', \r\n        justifyContent: 'space-between', \r\n        alignItems: 'center', \r\n        marginBottom: 12,\r\n        padding: '8px 0'\r\n      }}>\r\n        <button \r\n          className=\"calendar-nav-btn\" \r\n          onClick={() => { \r\n            const m = viewMonth - 1; \r\n            if (m < 0) { \r\n              setViewYear(v => v - 1); \r\n              setViewMonth(11); \r\n            } else {\r\n              setViewMonth(m); \r\n            }\r\n          }}\r\n          style={{\r\n            background: '#f8fafc',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '6px',\r\n            padding: '8px 10px',\r\n            cursor: 'pointer',\r\n            fontSize: '14px',\r\n            color: '#334155'\r\n          }}\r\n        >\r\n          {'◀'}\r\n        </button>\r\n        \r\n        <div style={{ display: 'flex', gap: 12, alignItems: 'center' }}>\r\n          <select \r\n            value={viewMonth} \r\n            onChange={e => setViewMonth(Number(e.target.value))}\r\n            style={{\r\n              background: '#fff',\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '6px',\r\n              padding: '6px 8px',\r\n              fontSize: '14px',\r\n              color: '#374151',\r\n              cursor: 'pointer',\r\n              minWidth: '120px'\r\n            }}\r\n          >\r\n            {monthNames.map((mn, idx) => <option key={mn} value={idx}>{mn}</option>)}\r\n          </select>\r\n          \r\n          <select \r\n            value={viewYear} \r\n            onChange={e => setViewYear(Number(e.target.value))}\r\n            style={{\r\n              background: '#fff',\r\n              border: '1px solid #d1d5db',\r\n              borderRadius: '6px',\r\n              padding: '6px 8px',\r\n              fontSize: '14px',\r\n              color: '#374151',\r\n              cursor: 'pointer',\r\n              minWidth: '80px'\r\n            }}\r\n          >\r\n            {Array.from({ length: 50 }).map((_, i) => viewYear - 4 + i).map(y => (\r\n              <option key={y} value={y}>{y}</option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n        \r\n        <button \r\n          className=\"calendar-nav-btn\"\r\n          onClick={() => { \r\n            const m = viewMonth + 1; \r\n            if (m > 11) { \r\n              setViewYear(v => v + 1); \r\n              setViewMonth(0); \r\n            } else {\r\n              setViewMonth(m); \r\n            }\r\n          }}\r\n          style={{\r\n            background: '#f8fafc',\r\n            border: '1px solid #e2e8f0',\r\n            borderRadius: '6px',\r\n            padding: '8px 10px',\r\n            cursor: 'pointer',\r\n            fontSize: '14px',\r\n            color: '#334155'\r\n          }}\r\n        >\r\n          {'▶'}\r\n        </button>\r\n      </div>\r\n\r\n      <div style={{ \r\n        display: 'grid', \r\n        gridTemplateColumns: 'repeat(7,1fr)', \r\n        gap: 4, \r\n        marginTop: 8, \r\n        fontSize: 12, \r\n        fontWeight: 600, \r\n        textAlign: 'center',\r\n        color: '#6b7280'\r\n      }}>\r\n        {['Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa', 'Su'].map(d => <div key={d}>{d}</div>)}\r\n      </div>\r\n\r\n      <div style={{ marginTop: 8 }}>\r\n        {weeks.map((week, i) => (\r\n          <div key={i} style={{ \r\n            display: 'grid', \r\n            gridTemplateColumns: 'repeat(7,1fr)', \r\n            gap: 4, \r\n            marginBottom: 4 \r\n          }}>\r\n            {week.map(d => {\r\n              const inMonth = d.getMonth() === viewMonth;\r\n              const isSelected = selected && \r\n                d.getFullYear() === selected.getFullYear() && \r\n                d.getMonth() === selected.getMonth() && \r\n                d.getDate() === selected.getDate();\r\n              const isToday = new Date().toDateString() === d.toDateString();\r\n              \r\n              return (\r\n                <button \r\n                  key={d.toISOString()} \r\n                  onClick={() => inMonth && selectDate(d)} \r\n                  style={{ \r\n                    padding: 8, \r\n                    borderRadius: 6, \r\n                    border: isToday ? '2px solid #3b82f6' : '1px solid transparent',\r\n                    background: isSelected ? '#1976d2' : (inMonth ? '#f8fafc' : 'transparent'), \r\n                    color: isSelected ? '#fff' : (inMonth ? '#374151' : '#9ca3af'),\r\n                    cursor: inMonth ? 'pointer' : 'default',\r\n                    fontSize: '13px',\r\n                    fontWeight: isSelected || isToday ? '600' : '400',\r\n                    transition: 'all 0.2s ease'\r\n                  }}\r\n                  onMouseEnter={(e) => {\r\n                    if (inMonth && !isSelected) {\r\n                      e.target.style.background = '#e2e8f0';\r\n                    }\r\n                  }}\r\n                  onMouseLeave={(e) => {\r\n                    if (inMonth && !isSelected) {\r\n                      e.target.style.background = '#f8fafc';\r\n                    }\r\n                  }}\r\n                >\r\n                  {d.getDate()}\r\n                </button>\r\n              );\r\n            })}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction formatValue(key, value) {\r\n  if (value === null || value === undefined) return '—';\r\n  const n = Number(value);\r\n  if (!Number.isNaN(n)) {\r\n  if (/pH/i.test(key)) return n.toFixed(3);\r\n    if (/DO|BOD|FC|TC|MPN/i.test(key)) return n.toFixed(2);\r\n    return String(n);\r\n  }\r\n  return String(value);\r\n}\r\n\r\nfunction cleanQualityString(quality) {\r\n  if (quality === null || quality === undefined) return quality;\r\n  let s = String(quality).trim();\r\n  if (!s) return s;\r\n  // normalize whitespace\r\n  s = s.replace(/\\s+/g, ' ');\r\n  // remove duplicated trailing punctuation and normalize\r\n  s = s.replace(/[\\s\\-–_:;,.]+$/g, '').trim();\r\n  // collapse exact repeated phrases like \"X X\" or \"X X X\" -> \"X\"\r\n  const m = s.match(/^(.*?)\\s+(?:\\1\\s+)*\\1$/i);\r\n  if (m && m[1]) return m[1].trim();\r\n  // fallback: if full-string repeated twice (older regex)\r\n  const m2 = s.match(/^(.*)\\s+\\1$/i);\r\n  return m2 ? m2[1].trim() : s;\r\n}\r\n\r\nfunction canonicalizePredictionEntries(pred) {\r\n  // returns array of [key, value] with keys normalized and duplicates collapsed (last value wins)\r\n  if (!pred || typeof pred !== 'object') return [];\r\n  const map = new Map();\r\n  for (const [k, v] of Object.entries(pred)) {\r\n    const key = String(k).trim();\r\n    const norm = key.toLowerCase().replace(/\\s+/g, ' ');\r\n    // map some common aliases\r\n    const canonical = norm === 'water quality' ? 'water quality' : norm;\r\n    map.set(canonical, { key: key, value: v });\r\n  }\r\n  // return in insertion order but using original key casing for display\r\n  return Array.from(map.values()).map(x => [x.key, x.value]);\r\n}\r\n\r\n// small helper component to forward map click events into lat/lon objects\r\nfunction MapClickHandler({ onMapClick }) {\r\n  useMapEvents({ click: (e) => { onMapClick && onMapClick({ latitude: e.latlng.lat, longitude: e.latlng.lng }); } });\r\n  return null;\r\n}\r\n\r\n// basic parameter status mapping used by badges in the UI\r\nfunction getParameterStatus(param, value) {\r\n  if (value === null || value === undefined) return { cls: 'status-na', label: 'N/A' };\r\n  const key = String(param || '').toLowerCase();\r\n  const v = Number(value);\r\n  if (key.includes('water quality')) {\r\n    const s = String(value || '').toLowerCase();\r\n    if (s.includes('good') || s.includes('ok') || s.includes('acceptable')) return { label: 'Good', cls: 'status-good' };\r\n    if (s.includes('moderate') || s.includes('borderline')) return { label: 'Moderate', cls: 'status-moderate' };\r\n    return { label: String(value), cls: 'status-poor' };\r\n  }\r\n  if (key.includes('pH')) {\r\n    if (isNaN(v)) return { label: String(value), cls: 'status-na' };\r\n    if (v >= 6.5 && v <= 8.5) return { label: 'Good', cls: 'status-good' };\r\n    if (v >= 6 && v < 6.5) return { label: 'Moderate', cls: 'status-moderate' };\r\n    return { label: 'Poor', cls: 'status-poor' };\r\n  }\r\n  if (key.includes('do')) {\r\n    if (isNaN(v)) return { label: String(value), cls: 'status-na' };\r\n    if (v >= 5) return { label: 'Good', cls: 'status-good' };\r\n    if (v >= 3) return { label: 'Moderate', cls: 'status-moderate' };\r\n    return { label: 'Poor', cls: 'status-poor' };\r\n  }\r\n  if (key.includes('bod')) {\r\n    if (isNaN(v)) return { label: String(value), cls: 'status-na' };\r\n    if (v <= 3) return { label: 'Good', cls: 'status-good' };\r\n    if (v <= 6) return { label: 'Moderate', cls: 'status-moderate' };\r\n    return { label: 'Poor', cls: 'status-poor' };\r\n  }\r\n  if (key.includes('fc mpn/100ml')) {\r\n    if (isNaN(v)) return { label: String(value), cls: 'status-na' };\r\n    if (v <= 500) return { label: 'Good', cls: 'status-good' };\r\n    if (v <= 1000) return { label: 'Moderate', cls: 'status-moderate' };\r\n    return { label: 'Poor', cls: 'status-poor' };\r\n  }\r\n  if (key.includes('tc mpn/100ml')) {\r\n    if (isNaN(v)) return { label: String(value), cls: 'status-na' };\r\n    if (v <= 1000) return { label: 'Good', cls: 'status-good' };\r\n    if (v <= 2000) return { label: 'Moderate', cls: 'status-moderate' };\r\n    return { label: 'Poor', cls: 'status-poor' };\r\n  }\r\n  return { label: String(value), cls: 'status-na' };\r\n}\r\n\r\nexport default function App() {\r\n  const [route, setRoute] = useState('home');\r\n  const [mapInst, setMapInst] = useState(null);\r\n  const [selectMode, setSelectMode] = useState(null);\r\n  const [startPoint, setStartPoint] = useState(null);\r\n  const [endPoint, setEndPoint] = useState(null);\r\n  const [interpPoints, setInterpPoints] = useState([]);\r\n  const [interpLoading, setInterpLoading] = useState(false);\r\n  const [sampleCount, setSampleCount] = useState(5);\r\n  const [selectedDate, setSelectedDate] = useState(() => {\r\n    const d = new Date();\r\n    return `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}-${String(d.getDate()).padStart(2, '0')}`;\r\n  });\r\n  const [predictions, setPredictions] = useState({});\r\n  const [selected, setSelected] = useState(null);\r\n  const [startInput, setStartInput] = useState('');\r\n  const [endInput, setEndInput] = useState('');\r\n  const [startRiver, setStartRiver] = useState(null);\r\n  const [endRiver, setEndRiver] = useState(null);\r\n  const [startStationName, setStartStationName] = useState(null);\r\n  const [endStationName, setEndStationName] = useState(null);\r\n  // Add missing state for forceIndexMedians\r\n  const [forceIndexMedians, setForceIndexMedians] = useState(false);\r\n\r\n  const handleMapClick = useCallback((pt) => {\r\n    if (selectMode === 'start') setStartPoint(pt);\r\n    else if (selectMode === 'end') setEndPoint(pt);\r\n  }, [selectMode]);\r\n\r\n  const handleMarkerClick = (loc) => {\r\n    // In interpolate route, if user is picking start or end, set them from known station\r\n    if (route === 'interpolate' && selectMode === 'start') {\r\n      const coord = loc.coordinate || loc;\r\n      setStartPoint({ latitude: coord.latitude, longitude: coord.longitude });\r\n      setStartInput(`${coord.latitude.toFixed(6)}, ${coord.longitude.toFixed(6)}`);\r\n      setStartRiver(loc.river || null);\r\n  setStartStationName(loc.name || null);\r\n      setSelectMode(null);\r\n      setInterpPoints([]);\r\n      return;\r\n    }\r\n    if (route === 'interpolate' && selectMode === 'end') {\r\n      // guard: do not allow picking end on a different river than start\r\n      if (startRiver && loc.river && startRiver !== loc.river) {\r\n        alert('Please pick an end station on the same river as the start station.');\r\n        setSelectMode(null);\r\n        return;\r\n      }\r\n      const coord = loc.coordinate || loc;\r\n      setEndPoint({ latitude: coord.latitude, longitude: coord.longitude });\r\n      setEndInput(`${coord.latitude.toFixed(6)}, ${coord.longitude.toFixed(6)}`);\r\n      setEndRiver(loc.river || null);\r\n  setEndStationName(loc.name || null);\r\n      setSelectMode(null);\r\n      setInterpPoints([]);\r\n      return;\r\n    }\r\n    // default behaviour: open details\r\n    setSelected(loc);\r\n    // attach available prediction\r\n    const pred = predictions[loc.id] || null;\r\n    setSelected(prev => ({...loc, prediction: pred}));\r\n  };\r\n\r\n  const performInterpolation = async () => {\r\n  if (!startPoint || !endPoint) return alert('Pick start and end');\r\n  setInterpLoading(true);\r\n    // use the provided sampled river segment (lat/lon array) and ask server to pick/sample across it\r\n    // find nearest indices in preSampledRiver for the selected start/end and slice that array\r\n    const nearestIndex = (pt) => {\r\n      let best = 0, bestD = Infinity;\r\n      for (let i=0;i<preSampledRiver.length;i++){\r\n        const dlat = preSampledRiver[i].latitude - pt.latitude;\r\n        const dlng = preSampledRiver[i].longitude - pt.longitude;\r\n        const d2 = dlat*dlat + dlng*dlng;\r\n        if (d2 < bestD){ bestD = d2; best = i; }\r\n      }\r\n      return best;\r\n    };\r\n    const si = nearestIndex(startPoint), ei = nearestIndex(endPoint);\r\n    const a = Math.min(si, ei), b = Math.max(si, ei);\r\n    const sub = preSampledRiver.slice(a, b+1);\r\n    const d = new Date(selectedDate);\r\n    const body = { locations: sub, points: sampleCount, month: d.getMonth()+1, year: d.getFullYear(), pick_from_input: true, blend: 'river' };\r\n    // include explicit station-name override only when user forces index medians\r\n    if (forceIndexMedians && startStationName && endStationName) {\r\n      body.start_station_name = startStationName;\r\n      body.end_station_name = endStationName;\r\n    }\r\n    try {\r\n      const res = await fetch(`${API_BASE}/interpolate_predict`, { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(body) });\r\n      const jb = await res.json();\r\n      if (jb.error) return alert('Server: '+jb.error);\r\n      const pts = jb.predictions || [];\r\n      setInterpPoints(pts);\r\n      // fit map to interpolated points if we have a map instance\r\n      try{\r\n        if (mapInst && pts && pts.length > 0){\r\n          const latlngs = pts.map(p => [p.latitude, p.longitude]);\r\n          mapInst.fitBounds(latlngs, { padding: [40,40] });\r\n        }\r\n      }catch(e){}\r\n    } catch (err) { alert('Request failed'); }\r\n    finally { setInterpLoading(false); }\r\n  };\r\n\r\n  function haversineKm(a, b) {\r\n    if (!a || !b) return 0;\r\n    const toRad = v => v * Math.PI / 180;\r\n    const R = 6371;\r\n    const dLat = toRad(b.latitude - a.latitude);\r\n    const dLon = toRad(b.longitude - a.longitude);\r\n    const lat1 = toRad(a.latitude);\r\n    const lat2 = toRad(b.latitude);\r\n    const sinDlat = Math.sin(dLat/2), sinDlon = Math.sin(dLon/2);\r\n    const aa = sinDlat*sinDlat + sinDlon*sinDlon * Math.cos(lat1)*Math.cos(lat2);\r\n    const c = 2 * Math.atan2(Math.sqrt(aa), Math.sqrt(1-aa));\r\n    return R * c;\r\n  }\r\n\r\n  const copyCoord = (pt) => {\r\n    if (!pt) return;\r\n    const s = `${pt.latitude.toFixed(6)}, ${pt.longitude.toFixed(6)}`;\r\n    try { navigator.clipboard && navigator.clipboard.writeText(s); } catch(e) {}\r\n  };\r\n\r\n  const clearStart = () => { setStartPoint(null); setInterpPoints([]); };\r\n  const clearEnd = () => { setEndPoint(null); setInterpPoints([]); };\r\n\r\n  // Fetch predictions for all stations when app loads or selectedDate changes\r\n  useEffect(() => {\r\n    async function fetchPredictions() {\r\n      if (!selectedDate) return;\r\n      try {\r\n        const d = new Date(selectedDate);\r\n        const month = d.getMonth() + 1;\r\n        const year = d.getFullYear();\r\n        const res = await fetch(`${API_BASE}/predict_all?month=${month}&year=${year}`);\r\n        const jb = await res.json();\r\n        if (jb && jb.predictions) {\r\n          // Map predictions to station id\r\n          const preds = {};\r\n          jb.predictions.forEach((pred) => {\r\n            // Find location by name\r\n            const loc = puneLocations.find(l => l.name === pred.location);\r\n            if (loc && loc.id) preds[loc.id] = pred;\r\n          });\r\n          setPredictions(preds);\r\n        }\r\n      } catch (err) {\r\n        // Optionally handle error\r\n      }\r\n    }\r\n    fetchPredictions();\r\n  }, [selectedDate]);\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <main className=\"main\" style={{display:'flex', gap:20}}>\r\n        <div style={{flex:1}}>\r\n          {route === 'home' ? (\r\n            <div className=\"home-page\">\r\n              <div className=\"home-card\">\r\n                <div className=\"home-hero\">\r\n                  <div className=\"logo\"><FaWater size={28} color=\"#fff\" /></div>\r\n                  <div>\r\n                    <h1>RiverWatch — Pune Rivers</h1>\r\n                    <p className=\"muted\">Water quality predictions for Pune rivers</p>\r\n                  </div>\r\n                </div>\r\n                <p>Explore predicted water quality across the Mula, Mutha and Mula-Mutha rivers. Use Predict for single-point queries and Interpolate to sample between two points.</p>\r\n                <div className=\"columns\">\r\n                  <div className=\"col rivers\">\r\n                    <h3>Rivers</h3>\r\n                    <div className=\"river-item\">\r\n                      <span className=\"river-name river-mula\">Mula</span>\r\n                      <div className=\"river-desc\">{(riverDescriptions['Mula'] || '').split('. ')[0]}.</div>\r\n                    </div>\r\n                    <div className=\"river-item\">\r\n                      <span className=\"river-name river-mutha\">Mutha</span>\r\n                      <div className=\"river-desc\">{(riverDescriptions['Mutha'] || '').split('. ')[0]}.</div>\r\n                    </div>\r\n                    <div className=\"river-item\">\r\n                      <span className=\"river-name river-mula-mutha\">Mula-Mutha</span>\r\n                      <div className=\"river-desc\">{(riverDescriptions['Mula-Mutha'] || '').split('. ')[0]}.</div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"col center\">\r\n                    <h3>About</h3>\r\n                    <p>This site reproduces the mobile water-quality model and exposes the same prediction logic on the web. It runs the trained model server-side and offers interpolation that follows river polylines so you can sample predicted values between two points. Use the map to select monitoring sites, compare parameter compliance across locations, and run multi-point interpolation to see spatial patterns for pH, dissolved oxygen, BOD and bacterial indicators across the river network.</p>\r\n                  </div>\r\n                  <div className=\"col params\">\r\n                    <h3>Parameters</h3>\r\n                    <ul className=\"param-names\">\r\n                      <li><strong>pH</strong> <div className=\"desc\">Measures water acidity and alkalinity on a scale of 0-14, with 7 being neutral. Deviations indicate pollution from industrial discharge or organic decomposition affecting aquatic life.</div></li>\r\n                      <li><strong>DO</strong> <div className=\"desc\">Dissolved oxygen levels in milligrams per liter, essential for fish and aquatic organisms. Low DO levels signal organic pollution and eutrophication from sewage or agricultural runoff.</div></li>\r\n                      <li><strong>BOD</strong> <div className=\"desc\">Biological oxygen demand measures oxygen consumed by microorganisms breaking down organic matter. High BOD indicates sewage contamination and reduces available oxygen for aquatic life.</div></li>\r\n                      <li><strong>FC/TC</strong> <div className=\"desc\">Fecal and total coliform bacteria counts per 100ml, indicating sewage contamination and potential health risks. High levels suggest inadequate wastewater treatment and pose serious public health concerns.</div></li>\r\n                    </ul>\r\n                  </div>\r\n                </div>\r\n                <div className=\"home-cta\">\r\n                  <button onClick={() => setRoute('predict')}>Go to Predict</button>\r\n                  <button className=\"secondary\" onClick={() => setRoute('interpolate')}>Go to Interpolate</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"main-content\" style={{height: 'calc(100vh - 36px)'}}>\r\n              <MapContainer center={[puneCenter.latitude, puneCenter.longitude]} zoom={puneCenter.zoom} className=\"map\" whenCreated={m=>setMapInst(m)} style={{height:'100%'}}>\r\n                <TileLayer url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\" />\r\n                <MapClickHandler onMapClick={handleMapClick} />\r\n                {puneLocations.map(loc => {\r\n                  const pred = predictions[loc.id] || null;\r\n                  const entries = pred ? canonicalizePredictionEntries(pred) : [];\r\n                  const overallEntry = entries.find(([k]) => String(k).toLowerCase() === 'water quality');\r\n                  const overallValue = overallEntry ? cleanQualityString(String(overallEntry[1])) : null;\r\n                  const overallStatus = overallEntry ? getParameterStatus('Water Quality', overallEntry[1]) : null;\r\n\r\n                  return (\r\n                    <CircleMarker key={loc.id} center={[loc.coordinate.latitude, loc.coordinate.longitude]} pathOptions={{ color: getRiverColor(loc.river), fillColor: getRiverColor(loc.river), fillOpacity:0.9 }} radius={8} eventHandlers={{ click: () => handleMarkerClick(loc) }}>\r\n                      <Popup>\r\n                        <div className=\"popup-card\" style={{minWidth:260}}>\r\n                          <div className=\"popup-header\">\r\n                            <div>\r\n                              <div className=\"popup-title\">{cleanQualityString(loc.name)}</div>\r\n                              <div className=\"popup-sub muted\" style={{display:'flex',gap:8,alignItems:'center',marginTop:8}}>\r\n                                <span className={`river-tag ${cleanQualityString(loc.river).replace(/\\s+/g, '-').toLowerCase()}`}>{cleanQualityString(loc.river)}</span>\r\n                                {overallValue ? <div className={`badge ${overallStatus ? overallStatus.cls : 'status-na'}`}>{overallValue}</div> : null}\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n\r\n                          {pred ? (\r\n                            <div className=\"popup-grid\">\r\n                              {entries\r\n                                .filter(([k]) => {\r\n                                  const key = String(k).toLowerCase();\r\n                                  return !['location','location_name','river','month','year','id','water quality'].includes(key);\r\n                                })\r\n                                .map(([k,v]) => {\r\n                                  const value = formatValue(k, v);\r\n                                  const s = getParameterStatus(k, v);\r\n                                  // For pH, show value and status side by side\r\n                                  if (String(k).toLowerCase() === 'pH') {\r\n                                    return (\r\n                                      <div className=\"param-row\" key={k}>\r\n                                        <div className=\"param-name\">{k}</div>\r\n                                        <div className=\"param-value\">\r\n                                          <span className=\"val-text\">{value}</span>\r\n                                          <span className={`badge ${s.cls}`} style={{marginLeft:8}}>{s.label}</span>\r\n                                        </div>\r\n                                      </div>\r\n                                    );\r\n                                  }\r\n                                  // For other parameters, show value and status as before\r\n                                  return (\r\n                                    <div className=\"param-row\" key={k}>\r\n                                      <div className=\"param-name\">{k}</div>\r\n                                      <div className=\"param-value\">\r\n                                        <span className=\"val-text\">{value}</span>\r\n                                        <span className={`badge ${s.cls}`} style={{marginLeft:8}}>{s.label}</span>\r\n                                      </div>\r\n                                    </div>\r\n                                  );\r\n                                })}\r\n                            </div>\r\n                          ) : <div style={{marginTop:8}}>Loading...</div>}\r\n                        </div>\r\n                      </Popup>\r\n                    </CircleMarker>\r\n                  );\r\n                })}\r\n                {route === 'interpolate' && startPoint ? <Marker position={[startPoint.latitude, startPoint.longitude]}><Popup>Start</Popup></Marker> : null}\r\n                {route === 'interpolate' && endPoint ? <Marker position={[endPoint.latitude, endPoint.longitude]}><Popup>End</Popup></Marker> : null}\r\n                {route === 'interpolate' && interpPoints.length > 0 && (\r\n                  <>\r\n                    <Polyline positions={interpPoints.map(p => [p.latitude, p.longitude])} pathOptions={{color:'#0077b6', weight:3, opacity:0.7}} />\r\n                    {interpPoints.map((pt, i) => (\r\n                      <CircleMarker key={i} center={[pt.latitude, pt.longitude]} radius={6} pathOptions={{color:'#0077b6', fillColor:'#00b4d8', fillOpacity:0.9}}>\r\n                        <Popup>\r\n                          <div style={{minWidth:220}}>\r\n                            <div style={{display:'flex',justifyContent:'space-between',alignItems:'center'}}>\r\n                              <div><strong>Interpolated</strong></div>\r\n                              <div className={`badge ${getParameterStatus('Water Quality', pt['Water Quality']).cls}`}>{cleanQualityString(pt['Water Quality'])}</div>\r\n                            </div>\r\n                            {/* Show pH, DO, BOD rows prominently */}\r\n                            {['pH', 'DO (mg/L)', 'BOD (mg/L)'].map((param, idx) => {\r\n                              const val = pt[param];\r\n                              const valStr = (val === null || val === undefined) ? '—' : Number(val).toFixed(3);\r\n                              const status = getParameterStatus(param, val);\r\n                              return (\r\n                                <div key={param} style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginTop:idx===0?8:4,borderTop:idx===0?'1px solid #edf2f7':'none',paddingTop:idx===0?8:0}}>\r\n                                  <div style={{fontSize:13,color:'#334155',fontWeight:700}}>{param}</div>\r\n                                  <div style={{display:'flex',alignItems:'center',gap:8}}>\r\n                                    <div style={{fontSize:18,fontWeight:800,color:'#0b3b52'}}>{valStr}</div>\r\n                                    <div className={`badge ${status.cls}`}>{status.label}</div>\r\n                                  </div>\r\n                                </div>\r\n                              );\r\n                            })}\r\n                            {/* Optionally show FC/TC if present */}\r\n                            {['FC MPN/100ml', 'TC MPN/100ml'].map((param) => {\r\n                              if (pt[param] !== undefined && pt[param] !== null) {\r\n                                const val = pt[param];\r\n                                const valStr = (val === null || val === undefined) ? '—' : Number(val).toFixed(2);\r\n                                const status = getParameterStatus(param, val);\r\n                                return (\r\n                                  <div key={param} style={{display:'flex',justifyContent:'space-between',alignItems:'center',marginTop:4}}>\r\n                                    <div style={{fontSize:13,color:'#334155',fontWeight:700}}>{param}</div>\r\n                                    <div style={{display:'flex',alignItems:'center',gap:8}}>\r\n                                      <div style={{fontSize:15,fontWeight:700,color:'#0b3b52'}}>{valStr}</div>\r\n                                      <div className={`badge ${status.cls}`}>{status.label}</div>\r\n                                    </div>\r\n                                  </div>\r\n                                );\r\n                              }\r\n                              return null;\r\n                            })}\r\n                            {/* show t_frac if returned by server */}\r\n                            {pt && (pt.t_frac !== undefined && pt.t_frac !== null) ? (\r\n                              <div style={{marginTop:8,fontSize:12,color:'#64748b'}}>Blend t: <strong>{Number(pt.t_frac).toFixed(3)}</strong></div>\r\n                            ) : null}\r\n                          </div>\r\n                        </Popup>\r\n                      </CircleMarker>\r\n                    ))}\r\n                  </>\r\n                )}\r\n              </MapContainer>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* right sidebar: show only on inner pages (not on Home) */}\r\n        {route !== 'home' && (\r\n          <aside className=\"detail-panel\" style={{width:360}}>\r\n          <div style={{display:'flex', justifyContent:'flex-end', gap:8, padding:8}}>\r\n            <button onClick={()=>setRoute('home')} className=\"small\">Home</button>\r\n            <button onClick={()=>setRoute('interpolate')} className=\"small primary\">Interpolate</button>\r\n          </div>\r\n          <div className=\"detail-calendar\">\r\n            <Calendar date={selectedDate} onChange={d=>setSelectedDate(d)} />\r\n          </div>\r\n\r\n          {route === 'interpolate' && (\r\n            <div style={{marginTop:12}}>\r\n              <div className=\"control-card\">\r\n                <div className=\"controls-row\" style={{marginBottom:8}}>\r\n                  <button onClick={()=>setSelectMode(selectMode==='start'?null:'start')} className={selectMode==='start'?'active small primary':''}>Pick Start</button>\r\n                  <button onClick={()=>setSelectMode(selectMode==='end'?null:'end')} className={selectMode==='end'?'active small primary':''}>Pick End</button>\r\n                  <button onClick={()=>{ setSelectMode(null); setInterpPoints([]); setStartPoint(null); setEndPoint(null); setStartInput(''); setEndInput(''); setStartRiver(null); setEndRiver(null); setStartStationName(null); setEndStationName(null); }} className=\"small\">Reset</button>\r\n                </div>\r\n                <div style={{marginBottom:8,color:'#0b3b52',fontSize:13}}><strong>Pick stations only</strong> — interpolation will use river-linear blending</div>\r\n\r\n                <div style={{display:'flex',gap:12,alignItems:'center',marginBottom:10}}>\r\n                  <label style={{margin:0,fontSize:13,color:'#475569'}}>Points k:</label>\r\n                  <input className=\"input-box\" type=\"number\" min={1} max={50} value={sampleCount} onChange={e=>setSampleCount(Number(e.target.value))} />\r\n                  <div style={{marginLeft:'auto'}}>\r\n                    <button className=\"small\" onClick={()=>{ setSampleCount( Math.min(50, (sampleCount||1)+1) ); }}>+1</button>\r\n                    <button className=\"small\" onClick={()=>{ setSampleCount( Math.max(1, (sampleCount||1)-1) ); }} style={{marginLeft:6}}>-1</button>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"coord-row\">\r\n                  <div className=\"coord-box\">\r\n                      <div className=\"coord-label\">Start</div>\r\n                      <input className=\"coord-input\" readOnly={route==='interpolate'} value={startInput || (startPoint?`${startPoint.latitude.toFixed(6)}, ${startPoint.longitude.toFixed(6)}`:'')} onChange={e=>setStartInput(e.target.value)} onBlur={(e)=>{\r\n                        if (route === 'interpolate') return; // disable manual entry while in interpolate mode\r\n                        const v = e.target.value.trim();\r\n                        if (!v) return;\r\n                        const parts = v.split(/[ ,]+/).map(x=>x.trim()).filter(Boolean);\r\n                        if (parts.length >= 2){ const lat = Number(parts[0]); const lon = Number(parts[1]); if (!isNaN(lat) && !isNaN(lon)) setStartPoint({latitude:lat, longitude:lon}); }\r\n                      }} onKeyDown={(e)=>{ if (e.key==='Enter'){ e.target.blur(); } }} placeholder=\"lat, lon\" />\r\n                    </div>\r\n                    <div className=\"coord-actions\">\r\n                      <button className=\"small\" onClick={()=>{ copyCoord(startPoint); }} disabled={!startPoint}><FaCopy/></button>\r\n                      <button className=\"small\" disabled={route==='interpolate'} onClick={async ()=>{ try { const t = await navigator.clipboard.readText(); setStartInput(t); const parts = t.split(/[ ,]+/).map(x=>x.trim()).filter(Boolean); if (parts.length>=2){ const lat=Number(parts[0]), lon=Number(parts[1]); if (!isNaN(lat)&&!isNaN(lon)) setStartPoint({latitude:lat, longitude:lon}); } } catch(e){} }} title=\"Paste from clipboard\"><FaPaste/></button>\r\n                      <button className=\"small\" onClick={()=>{ clearStart(); setStartInput(''); setStartRiver(null); setStartStationName(null); }} disabled={!startPoint} style={{marginLeft:6}}><FaTrash/></button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"coord-row\">\r\n                  <div className=\"coord-box\">\r\n                      <div className=\"coord-label\">End</div>\r\n                      <input className=\"coord-input\" readOnly={route==='interpolate'} value={endInput || (endPoint?`${endPoint.latitude.toFixed(6)}, ${endPoint.longitude.toFixed(6)}`:'')} onChange={e=>setEndInput(e.target.value)} onBlur={(e)=>{\r\n                        if (route === 'interpolate') return; // disable manual entry while in interpolate mode\r\n                        const v = e.target.value.trim();\r\n                        if (!v) return;\r\n                        const parts = v.split(/[ ,]+/).map(x=>x.trim()).filter(Boolean);\r\n                        if (parts.length >= 2){ const lat = Number(parts[0]); const lon = Number(parts[1]); if (!isNaN(lat) && !isNaN(lon)) setEndPoint({latitude:lat, longitude:lon}); }\r\n                      }} onKeyDown={(e)=>{ if (e.key==='Enter'){ e.target.blur(); } }} placeholder=\"lat, lon\" />\r\n                    </div>\r\n                    <div className=\"coord-actions\">\r\n                      <button className=\"small\" onClick={()=>{ copyCoord(endPoint); }} disabled={!endPoint}><FaCopy/></button>\r\n                      <button className=\"small\" disabled={route==='interpolate'} onClick={async ()=>{ try { const t = await navigator.clipboard.readText(); setEndInput(t); const parts = t.split(/[ ,]+/).map(x=>x.trim()).filter(Boolean); if (parts.length>=2){ const lat=Number(parts[0]), lon=Number(parts[1]); if (!isNaN(lat)&&!isNaN(lon)) setEndPoint({latitude:lat, longitude:lon}); } } catch(e){} }} title=\"Paste from clipboard\"><FaPaste/></button>\r\n                      <button className=\"small\" onClick={()=>{ clearEnd(); setEndInput(''); setEndRiver(null); setEndStationName(null); }} disabled={!endPoint} style={{marginLeft:6}}><FaTrash/></button>\r\n                    </div>\r\n                </div>\r\n\r\n                <div style={{marginTop:8,display:'flex',alignItems:'center',justifyContent:'space-between'}}>\r\n                  <div className=\"muted\">Distance: <strong style={{color:'#233249'}}>{(startPoint && endPoint)?`${haversineKm(startPoint,endPoint).toFixed(2)} km`:'—'}</strong></div>\r\n                  <div style={{display:'flex',alignItems:'center',gap:8,marginLeft:12}}>\r\n                    <div style={{fontSize:12,color:'#475569'}}>{forceIndexMedians ? 'Mode: Index medians (override)' : 'Mode: Distance/projection'}</div>\r\n                    <button className=\"btn-primary\" onClick={performInterpolation} disabled={!startPoint || !endPoint || interpLoading}>{interpLoading ? 'Interpolating…' : 'Interpolate'}</button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <div style={{marginTop:16}}>\r\n            <div className=\"selected-date\">Selected date: <strong>{new Date(selectedDate).toLocaleDateString()}</strong></div>\r\n                {selected ? (\r\n              <div style={{marginTop:12}}>\r\n                <h3>{cleanQualityString(selected.name)}</h3>\r\n                <div className=\"muted\" style={{display:'flex', justifyContent:'space-between', alignItems:'center'}}>\r\n                  <div><span className={`river-tag ${cleanQualityString(selected.river).replace(/\\s+/g, '-').toLowerCase()}`}>{cleanQualityString(selected.river)}</span> • {selected.description}</div>\r\n                  {selected.prediction ? (() => {\r\n                    const entries = canonicalizePredictionEntries(selected.prediction);\r\n                    const overall = entries.find(([k]) => String(k).toLowerCase() === 'water quality');\r\n                    if (overall) {\r\n                      const s = getParameterStatus('Water Quality', overall[1]);\r\n                      return <div className={`badge ${s ? s.cls : 'status-na'}`}>{cleanQualityString(String(overall[1]))}</div>;\r\n                    }\r\n                    return null;\r\n                  })() : null}\r\n                </div>\r\n                <h4 style={{marginTop:8}}>Prediction</h4>\r\n                {selected.prediction ? (\r\n                  <div>\r\n                    {canonicalizePredictionEntries(selected.prediction)\r\n                      .filter(([k]) => {\r\n                        const key = String(k).toLowerCase();\r\n                        return !['location','location_name','river','month','year','id','water quality'].includes(key);\r\n                      })\r\n                      .map(([k,v])=>{\r\n                        const value = formatValue(k, v);\r\n                        const s = getParameterStatus(k,v);\r\n                        return (\r\n                          <div key={k} className=\"inline-param-row\">\r\n                            <div className=\"label\">{k}</div>\r\n                            <div className=\"value\"><div className=\"val-text\">{value}</div><div className={`badge ${s.cls}`}>{s.label}</div></div>\r\n                          </div>\r\n                        );\r\n                      })}\r\n                  </div>\r\n                ) : <div>Loading...</div>}\r\n              </div>\r\n            ) : (\r\n              <div className=\"placeholder\" style={{marginTop:12}}>Select a location on the map to see details here.</div>\r\n            )}\r\n          </div>\r\n          </aside>\r\n        )}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}